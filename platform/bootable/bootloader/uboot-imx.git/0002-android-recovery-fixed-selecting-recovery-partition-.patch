From ca1bdb5abbfbe97e4e64d8d42bfa7d3449f7dc3a Mon Sep 17 00:00:00 2001
From: Ruslan Filipovich <ruslan.filipovich@promwad.com>
Date: Sat, 28 May 2016 14:54:33 +0300
Subject: [PATCH 2/3] android-recovery: fixed selecting recovery partition if
 boot from nand

---
 board/variscite/mx6var_som/mx6var_som.c | 2 +-
 include/configs/mx6var_som_android.h    | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/board/variscite/mx6var_som/mx6var_som.c b/board/variscite/mx6var_som/mx6var_som.c
index ea2445d..e72aac7 100644
--- a/board/variscite/mx6var_som/mx6var_som.c
+++ b/board/variscite/mx6var_som/mx6var_som.c
@@ -1347,7 +1347,7 @@ void board_recovery_setup(void)
 	default:
 		printf("Unsupported bootup device for recovery: dev: %d\n",
 			bootdev);
-		return;
+		break;
 	}
 
 	printf("setup env for recovery..\n");
diff --git a/include/configs/mx6var_som_android.h b/include/configs/mx6var_som_android.h
index 6e59775..85dc1b0 100644
--- a/include/configs/mx6var_som_android.h
+++ b/include/configs/mx6var_som_android.h
@@ -35,11 +35,13 @@
 #ifdef CONFIG_SYS_BOOT_NAND
 #define BOOT_ENV_SETTINGS \
 	"bootcmd=boota mmc1\0" \
-	"fastboot_dev=mmc1\0"
+	"fastboot_dev=mmc1\0" \
+	"bootcmd_android_recovery=boota mmc1 recovery\0"
 #else
 #define BOOT_ENV_SETTINGS \
 	"bootcmd=boota mmc0\0" \
-	"fastboot_dev=mmc0\0"
+	"fastboot_dev=mmc0\0" \
+	"bootcmd_android_recovery=boota mmc0 recovery\0"
 #endif
 
 #define CONFIG_EXTRA_ENV_SETTINGS \
-- 
2.1.4

