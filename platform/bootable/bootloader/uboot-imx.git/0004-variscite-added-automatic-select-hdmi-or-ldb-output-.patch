From 5fbe6bf4f874a8dd54b1940f40fd74f2668fe064 Mon Sep 17 00:00:00 2001
From: Ruslan Filipovich <ruslan.filipovich@promwad.com>
Date: Fri, 3 Jun 2016 11:12:10 +0300
Subject: [PATCH 4/4] variscite: added automatic select hdmi or ldb output for
 android screen

---
 include/configs/mx6var_som_android.h | 40 ++++++++++++++++++++++++++++++++----
 1 file changed, 36 insertions(+), 4 deletions(-)

diff --git a/include/configs/mx6var_som_android.h b/include/configs/mx6var_som_android.h
index 85dc1b0..542da76 100644
--- a/include/configs/mx6var_som_android.h
+++ b/include/configs/mx6var_som_android.h
@@ -34,14 +34,22 @@
 
 #ifdef CONFIG_SYS_BOOT_NAND
 #define BOOT_ENV_SETTINGS \
-	"bootcmd=boota mmc1\0" \
+	"bootcmd=" \
+		"run videoargs; " \
+		"boota mmc1\0" \
 	"fastboot_dev=mmc1\0" \
-	"bootcmd_android_recovery=boota mmc1 recovery\0"
+	"bootcmd_android_recovery=" \
+		"run videoargs; " \
+		"boota mmc1 recovery\0"
 #else
 #define BOOT_ENV_SETTINGS \
-	"bootcmd=boota mmc0\0" \
+	"bootcmd=" \
+		"run videoargs; " \
+		"boota mmc0\0" \
 	"fastboot_dev=mmc0\0" \
-	"bootcmd_android_recovery=boota mmc0 recovery\0"
+	"bootcmd_android_recovery=" \
+		"run videoargs; " \
+		"boota mmc0 recovery\0"
 #endif
 
 #define CONFIG_EXTRA_ENV_SETTINGS \
@@ -49,6 +57,30 @@
 	"splashpos=m,m\0" \
 	"fdt_high=0xffffffff\0" \
 	"initrd_high=0xffffffff\0" \
+	"bootargs=" \
+		"console=ttymxc0,115200 " \
+		"init=/init " \
+		"vmalloc=256M " \
+		"androidboot.console=ttymxc0 " \
+		"consoleblank=0 " \
+		"androidboot.hardware=freescale " \
+		"cma=384M " \
+		"androidboot.selinux=disabled\0" \
+	"videoargs=" \
+		"if hdmidet; then " \
+			"setenv bootargs ${bootargs} " \
+				"video=mxcfb0:dev=hdmi,1920x1080M@60,if=RGB24; " \
+		"else " \
+			"setenv bootargs ${bootargs} " \
+				"video=mxcfb0:dev=ldb,bpp=32; " \
+		"fi; " \
+		"setenv bootargs ${bootargs} " \
+			"video=mxcfb1:off video=mxcfb2:off video=mxcfb3:off; " \
+		"i2c dev 2; " \
+		"if i2c probe 0x38; then " \
+			"setenv bootargs ${bootargs} " \
+				"screen_alternate=yes;" \
+		"fi;\0"
 
 
 #define CONFIG_USB_FASTBOOT_BUF_ADDR   CONFIG_SYS_LOAD_ADDR
-- 
2.1.4

